@* @model IEnumerable<Masterpiece.Models.Cart> *@

@* @{ *@
@*     ViewData["Title"] = "Cart"; *@
@* } *@

@* <div class="container mt-5"> *@
@*     <h2 class="mb-4">Shopping Cart</h2> *@

@*     @if (!Model.CartItems.Any()) *@
@*     { *@
@*         <div class="alert alert-info">Your cart is empty.</div> *@
@*     } *@
@*     else *@
@*     { *@
@*         <form method="post"> *@
@*             <table class="table table-bordered table-hover align-middle"> *@
@*                 <thead class="table-dark"> *@
@*                     <tr> *@
@*                         <th>Product</th> *@
@*                         <th>Price</th> *@
@*                         <th style="width: 120px;">Quantity</th> *@
@*                         <th>Subtotal</th> *@
@*                         <th style="width: 150px;">Actions</th> *@
@*                     </tr> *@
@*                 </thead> *@
@*                 <tbody> *@
@*                     @foreach (var item in Model.CartItems) *@
@*                     { *@
@*                         <tr> *@
@*                             <td> *@
@*                                 <div class="d-flex align-items-center"> *@
@*                                     <img src="@item.Product.image_url" alt="@item.Product.name" style="width: 60px; height: auto; margin-right: 10px;" /> *@
@*                                     <span>@item.Product.name</span> *@
@*                                 </div> *@
@*                             </td> *@
@*                             <td>@item.Product.price.ToString("C")</td> *@
@*                             <td> *@
@*                                 <form method="post" asp-page-handler="Update"> *@
@*                                     <input type="hidden" name="id" value="@item.id" /> *@
@*                                     <div class="input-group"> *@
@*                                         <input type="number" name="quantity" value="@item.quantity" class="form-control form-control-sm" min="1" /> *@
@*                                         <button type="submit" class="btn btn-sm btn-outline-primary">Update</button> *@
@*                                     </div> *@
@*                                 </form> *@
@*                             </td> *@
@*                             <td>@(item.Product.price * item.quantity).ToString("C")</td> *@
@*                             <td> *@
@*                                 <form method="post" asp-page-handler="Delete" onsubmit="return confirm('Are you sure?');"> *@
@*                                     <input type="hidden" name="id" value="@item.id" /> *@
@*                                     <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button> *@
@*                                 </form> *@
@*                             </td> *@
@*                         </tr> *@
@*                     } *@
@*                 </tbody> *@
@*             </table> *@
@*         </form> *@

@*         <div class="text-end"> *@
@*             <h4>Total: <strong>@Model.Total.ToString("C")</strong></h4> *@
@*             <button class="btn btn-success mt-2">Checkout</button> *@
@*         </div> *@
@*     } *@
@* </div> *@







@model Masterpiece.ViewModel.CartsVM

@{
    ViewData["Title"] = "Your Shopping Cart";
}



@* <div class="container py-5"> *@
@*     <h2 class="text-center mb-4">Your Shopping Cart</h2> *@

@*     @if (Model.CartItems != null && Model.CartItems.Any()) *@
@*     { *@
@*         <div class="row"> *@
@*             <!-- Cart Items Column --> *@
@*             <div class="col-lg-8"> *@
@*                 <div class="card shadow-sm mb-4"> *@
@*                     <div class="card-body p-0"> *@
@*                         <div class="table-responsive"> *@
@*                             <table class="table mb-0"> *@
@*                                 <thead class="table-light"> *@
@*                                     <tr> *@
@*                                         <th scope="col" style="width: 100px;">Image</th> *@
@*                                         <th scope="col">Product</th> *@
@*                                         <th scope="col" class="text-end">Price</th> *@
@*                                         <th scope="col">Quantity</th> *@
@*                                         <th scope="col" class="text-end">Subtotal</th> *@
@*                                         <th scope="col">Action</th> *@
@*                                     </tr> *@
@*                                 </thead> *@
@*                                 <tbody> *@
@*                                     @foreach (var cartItem in Model.CartItems) *@
@*                                     { *@
@*                                         <tr> *@
@*                                             <td> *@
@*                                                 <img src="@cartItem.ImageUrl" alt="Product Image" class="img-fluid rounded" style="max-height: 60px;"> *@
@*                                             </td> *@
@*                                             <td>@cartItem.ProductName</td> *@
@*                                             <td class="text-end">@cartItem.Price.ToString("C")</td> *@
@*                                             <td> *@
@*                                                 <form method="post" action="@Url.Action("UpdateQuantity", "payment")" class="d-flex align-items-center"> *@
@*                                                     <input type="hidden" name="cartItemId" value="@cartItem.CartItemId" /> *@
@*                                                     <input type="number" name="newQuantity" value="@cartItem.Quantity" *@
@*                                                            class="form-control form-control-sm" style="width: 70px;" min="1" /> *@
@*                                                     <button type="submit" class="btn btn-sm btn-outline-primary ms-2"> *@
@*                                                         Update *@
@*                                                     </button> *@
@*                                                 </form> *@
@*                                             </td> *@
@*                                             <td class="text-end">@cartItem.Subtotal.ToString("C")</td> *@
@*                                             <td> *@
@*                                                 <form method="post" action="@Url.Action("RemoveItem", "payment")" class="d-inline"> *@
@*                                                     <input type="hidden" name="cartItemId" value="@cartItem.CartItemId" /> *@
@*                                                     <button type="submit" class="btn btn-sm btn-outline-danger"> *@
@*                                                         Remove *@
@*                                                     </button> *@
@*                                                 </form> *@
@*                                             </td> *@
@*                                         </tr> *@
@*                                     } *@
@*                                 </tbody> *@
@*                             </table> *@
@*                         </div> *@
@*                     </div> *@
@*                 </div> *@
@*             </div> *@

@*             <!-- Summary Column --> *@
@*             <div class="col-lg-4"> *@
@*                 <div class="card shadow-sm"> *@
@*                     <div class="card-body"> *@
@*                         <h5 class="card-title mb-3">Cart Summary</h5> *@
@*                         <div class="d-flex justify-content-between mb-2"> *@
@*                             <span>Subtotal (@Model.CartItems.Count items)</span> *@
@*                             <span>@Model.CartItems.Sum(x => x.Subtotal).ToString("C")</span> *@
@*                         </div> *@
@*                         <div class="d-flex justify-content-between mb-3"> *@
@*                             <span>Shipping</span> *@
@*                             <span class="text-success">Calculated at checkout</span> *@
@*                         </div> *@
@*                         <hr> *@
@*                         <div class="d-flex justify-content-between fw-bold mb-4"> *@
@*                             <span>Total</span> *@
@*                             <span>@Model.CartItems.Sum(x => x.Subtotal).ToString("C")</span> *@
@*                         </div> *@
@*                         <a href="/Checkout" class="btn btn-success w-100">Proceed to Checkout</a> *@
@*                         <a href="/Products" class="btn btn-outline-secondary w-100 mt-2">Continue Shopping</a> *@
@*                     </div> *@
@*                 </div> *@
@*             </div> *@
@*         </div> *@
@*     } *@
@*     else *@
@*     { *@
@*         <div class="card shadow-sm"> *@
@*             <div class="card-body text-center py-5"> *@
@*                 <i class="bi bi-cart-x fs-1 text-muted mb-3"></i> *@
@*                 <h3 class="mb-3">Your cart is empty</h3> *@
@*                 <p class="text-muted mb-4">Looks like you haven't added any items to your cart yet.</p> *@
@*                 <a href="/Products" class="btn btn-primary">Browse Products</a> *@
@*             </div> *@
@*         </div> *@
@*     } *@
@* </div> *@






































@* <div class="container py-4"> *@
@*     <div class="row"> *@
@*         <div class="col-12"> *@
@*             <div class="d-flex justify-content-between align-items-center mb-4"> *@
@*                 <h2 class="mb-0">Your Cart</h2> *@
@*                 <span class="badge bg-primary rounded-pill">@(Model.CartItems?.Count ?? 0) items</span> *@
@*             </div> *@
            
@*             @if (Model.CartItems?.Count > 0) *@
@*             { *@
@*                 <div class="row"> *@
@*                     <!-- Cart Items Column --> *@
@*                     <div class="col-lg-8 pe-lg-4"> *@
@*                         <div class="card border-0 shadow-sm mb-4"> *@
@*                             <div class="card-body p-0"> *@
@*                                 <div class="list-group list-group-flush"> *@
@*                                     @foreach (var item in Model.CartItems) *@
@*                                     { *@
@*                                         <div class="list-group-item p-3"> *@
@*                                             <div class="row align-items-center"> *@
@*                                                 <div class="col-3 col-md-2"> *@
@*                                                     <img src="@item.ImageUrl" class="img-fluid rounded-3" alt="@item.ProductName"> *@
@*                                                 </div> *@
@*                                                 <div class="col-5 col-md-6"> *@
@*                                                     <h5 class="mb-1">@item.ProductName</h5> *@
@*                                                     <div class="d-flex align-items-center mt-2"> *@
@*                                                         <form method="post" asp-page-handler="RemoveItem" class="me-2"> *@
@*                                                             <input type="hidden" name="cartItemId" value="@item.CartItemId" /> *@
@*                                                             <button type="submit" class="btn btn-sm btn-outline-danger"> *@
@*                                                                 <i class="bi bi-trash"></i> Remove *@
@*                                                             </button> *@
@*                                                         </form> *@
@*                                                     </div> *@
@*                                                 </div> *@
@*                                                 <div class="col-4 col-md-4"> *@
@*                                                     <div class="d-flex flex-column align-items-end"> *@
@*                                                         <span class="fw-bold mb-2">$@((item.Price * item.Quantity).ToString("N2"))</span> *@
@*                                                         @* <form method="post" asp-action="UpdateQuantity" asp-controller="Cart" class="quantity-selector"> *@ 
@*                                                         @*     <input type="hidden" name="cartItemId" value="@item.CartItemId" /> *@ 
@*                                                         @*     <div class="input-group input-group-sm" style="width: 120px;"> *@ 
@*                                                         @*         <button class="btn btn-outline-secondary minus-btn" type="button">-</button> *@ 
@*                                                         @*         <input type="number" name="newQuantity" value="@item.Quantity" min="1" max="99"  *@ 
@*                                                         @*                class="form-control text-center quantity-input"> *@ 
@*                                                         @*         <button class="btn btn-outline-secondary plus-btn" type="button">+</button> *@ 
@*                                                         @*     </div> *@ 
@*                                                         @* </form> *@ 

@*                                                         <form class="quantity-form" data-cart-item-id="@item.CartItemId"> *@
@*                                                             <div class="input-group"> *@
@*                                                                 <button class="minus-btn" type="button">-</button> *@
@*                                                                 <input class="quantity-input" type="number" value="@item.Quantity"> *@
@*                                                                 <button class="plus-btn" type="button">+</button> *@
@*                                                             </div> *@
@*                                                         </form> *@

@*                                                     </div> *@
@*                                                 </div> *@
@*                                             </div> *@
@*                                         </div> *@
@*                                     } *@
@*                                 </div> *@
@*                             </div> *@
@*                         </div> *@
                        
@*                         <div class="d-flex justify-content-between"> *@
@*                             <a href="/Products" class="btn btn-outline-primary"> *@
@*                                 <i class="bi bi-arrow-left"></i> Continue Shopping *@
@*                             </a> *@
@*                             <button class="btn btn-primary" onclick="location.href='/Checkout'"> *@
@*                                 Checkout <i class="bi bi-arrow-right"></i> *@
@*                             </button> *@
@*                         </div> *@
@*                     </div> *@
                    
@*                     <!-- Order Summary Column --> *@
@*                     <div class="col-lg-4 mt-4 mt-lg-0"> *@
@*                         <div class="card border-0 shadow-sm sticky-top" style="top: 20px;"> *@
@*                             <div class="card-body"> *@
@*                                 <h5 class="card-title mb-3">Order Summary</h5> *@
                                
@*                                 <div class="d-flex justify-content-between mb-2"> *@
@*                                     <span>Subtotal (@Model.CartItems.Count items)</span> *@
@*                                     <span>@Model.CartItems.Sum(x => x.Subtotal).ToString("C")</span> *@
@*                                 </div> *@
                                
@*                                 <div class="d-flex justify-content-between mb-2"> *@
@*                                     <span>Shipping</span> *@
@*                                     <span class="text-success">FREE</span> *@
@*                                 </div> *@
                                
@*                                 <div class="d-flex justify-content-between mb-3"> *@
@*                                     <span>Tax</span> *@
@*                                     <span>Calculated at checkout</span> *@
@*                                 </div> *@
                                
@*                                 <hr> *@
                                
@*                                 <div class="d-flex justify-content-between fw-bold fs-5 mb-4"> *@
@*                                     <span>Total</span> *@
@*                                     <span>@Model.CartItems.Sum(x => x.Subtotal).ToString("C")</span> *@
@*                                 </div> *@
                                
@*                                 <div class="d-grid gap-2"> *@
@*                                     <button class="btn btn-primary btn-lg" onclick="location.href='/Checkout'"> *@
@*                                         Proceed to Checkout *@
@*                                     </button> *@
@*                                 </div> *@
                                
@*                                 <div class="mt-3 text-center"> *@
@*                                     <small class="text-muted"> *@
@*                                         <i class="bi bi-lock-fill"></i> Secure checkout *@
@*                                     </small> *@
@*                                 </div> *@
@*                             </div> *@
@*                         </div> *@
@*                     </div> *@
@*                 </div> *@
@*             } *@
@*             else *@
@*             { *@
@*                 <div class="card border-0 shadow-sm"> *@
@*                     <div class="card-body text-center py-5"> *@
@*                         <div class="mb-4"> *@
@*                             <i class="bi bi-cart-x" style="font-size: 3rem; color: #adb5bd;"></i> *@
@*                         </div> *@
@*                         <h3 class="mb-3">Your cart is empty</h3> *@
@*                         <p class="text-muted mb-4">Looks like you haven't added any items to your cart yet.</p> *@
@*                         <a href="/Products" class="btn btn-primary px-4"> *@
@*                             <i class="bi bi-shop"></i> Start Shopping *@
@*                         </a> *@
@*                     </div> *@
@*                 </div> *@
@*             } *@
@*         </div> *@
@*     </div> *@
@* </div> *@

@* @section Styles { *@
@*     <style> *@
@*         .quantity-selector .input-group { *@
@*             border-radius: 20px; *@
@*             overflow: hidden; *@
@*         } *@
@*         .quantity-selector .form-control { *@
@*             border-left: 0; *@
@*             border-right: 0; *@
@*         } *@
@*         .quantity-selector .minus-btn,  *@
@*         .quantity-selector .plus-btn { *@
@*             width: 40px; *@
@*         } *@
@*         .list-group-item { *@
@*             border-color: rgba(0,0,0,.05); *@
@*         } *@
@*         .sticky-top { *@
@*             z-index: 1; *@
@*         } *@
@*     </style> *@
@* } *@


















<div class="container my-5">
    <h2 class="text-center mb-4">Your Shopping Cart</h2>

    <!-- Check if there are any cart items -->
    @if (Model.CartItems != null && Model.CartItems.Any())
    {
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th scope="col">Product</th>
                    <th scope="col">Image</th>
                    <th scope="col">Price</th>
                    <th scope="col">Quantity</th>
                    <th scope="col">Subtotal</th>
                    <th scope="col">Action</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var cartItem in Model.CartItems)
                {
                    <tr>
                        <td>@cartItem.ProductName</td>
                        <td><img src="@cartItem.ImageUrl" alt="Product Image" width="50" height="50" /></td>
                        <td>@cartItem.Price.ToString("C")</td>
                        <td>
                            <form method="post" action="@Url.Action("UpdateQuantity", "payment")">
                                <input type="hidden" name="cartItemId" value="@cartItem.CartItemId" />
                                <input type="number" name="newQuantity" value="@cartItem.Quantity" class="form-control" style="width: 80px;" min="1" />
                                <button type="submit" class="btn btn-primary btn-sm mt-2">Update</button>
                            </form>
                        </td>
                        <td>@cartItem.Subtotal.ToString("C")</td>
                        <td>
                            <form method="post" action="@Url.Action("RemoveItem", "payment")">
                                <input type="hidden" name="cartItemId" value="@cartItem.CartItemId" />
                                <button type="submit" class="btn btn-danger btn-sm">Remove</button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        <!-- Cart summary -->
        <div class="d-flex justify-content-end">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Cart Summary</h5>
                    <p class="card-text">Total Price: <strong>@Model.CartItems.Sum(x => x.Subtotal).ToString("C")</strong></p>
                    <a asp-action="Index" class="btn btn-success">Proceed to Checkout</a>
                </div>
            </div>
        </div>
    }
    else
    {
        <div class="alert alert-warning" role="alert">
            Your cart is empty!
        </div>
    }
</div>

